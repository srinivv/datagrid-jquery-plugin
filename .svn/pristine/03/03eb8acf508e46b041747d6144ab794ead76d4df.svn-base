package com.cisco.apas.entity;

import java.util.List;

public class Scenario extends AbstractRuleEntity implements OperandToken {
	private static final long serialVersionUID = -6574367965245081890L;
	private Rule rule;
	private List<Leaf> Leaves;
	
	private Expression scenarioExpression;

	public Rule getRule() {
		return rule;
	}

	public void setRule(Rule rule) {
		this.rule = rule;
	}

	public List<Leaf> getLeaves() {
		return Leaves;
	}

	public void setLeaves(List<Leaf> leaves) {
		Leaves = leaves;
	}

	public Expression getScenarioExpression() {
		return scenarioExpression;
	}

	public void setScenarioExpression(Expression ruleExpression) {
		this.scenarioExpression = ruleExpression;
	}

	public String getTokenValue() {
		// TODO Auto-generated method stub
		return getId().toString();
	}

	public void setTokenValue(String tokenValue) {
		// TODO Auto-generated method stub
		
	}
	
	public void populateTokenExpression() {
		List<String> tokens = tokenizeExpression(this.getExpression(), false);
		System.out.println(tokens);
		for(String token : tokens) {
			if(token == null || token.length() == 0) {
				continue;
			} else if("(".equals(token)) {
				getTokenExpressions().add(new StartToken());
			} else if(")".equals(token)) {
				getTokenExpressions().add(new EndToken());
			} else if("&&".equals(token)) {
				getTokenExpressions().add(new AndCondition());
			} else if("||".equals(token)) {
				getTokenExpressions().add(new OrCondition());
			} else {
				Leaf leaf = getLeaf(Long.valueOf(token));
				getTokenExpressions().add(leaf);
			}
		}
	}
	
	private Leaf getLeaf(Long id) {
		for(Leaf leaf : Leaves) {
			if(id.equals(leaf.getId())) {
				return leaf;
			}
		}
		return null;
	}
}
