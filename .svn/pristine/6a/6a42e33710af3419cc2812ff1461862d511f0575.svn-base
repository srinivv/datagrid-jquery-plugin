// For Tabs START
// JavaScript Document

  $(function() {
    var	  tabTemplate = "<li><a href='#{href}'>#{label}</a> <span class='ui-icon ui-icon-close'>Remove Tab</span></li>",
      tabCounter = 1;
    
    //Now show the tab.
    var tabs = $( "#tabs" ).tabs();
    //First add a default tab
    addTab();
    //Open the first tab
    $("#tabs").tabs({selected: 0});
    
    // actual addTab function: adds new tab using the input from the form above
    function addTab() {
      var label = 'Business Rule '  + tabCounter,
        id = "tabs-" + tabCounter,
        li = $( tabTemplate.replace( /#\{href\}/g, "#" + id ).replace( /#\{label\}/g, label ) ),
        tabContentHtml = _.template($('#rule-tab-template').html());
 
      tabs.find( ".ui-tabs-nav" ).append( li );
      templateDefault =_.template($('#node-scenario-template').html(), { id:id,cssName: '' ,top: '0px',tierArea:'',dataTop:''});
      tabs.append( _.template($('#rule-tab-template').html(),{id:id}));  
      //Show Default Scenario.
      tabs.find('.nodeMainArea').append(templateDefault);
      //Refresh the tabs.
      tabs.tabs( "refresh" );
      tabCounter++;
    }
 
    // close icon: removing the tab on click
    $( "#tabs span.ui-icon-close" ).live( "click", function() {
      var panelId = $( this ).closest( "li" ).remove().attr( "aria-controls" );
      $( "#" + panelId ).remove();
      tabs.tabs( "refresh" );
      //Decrement the tab 
      tabCounter =  tabCounter-1;
    });
  //Adding more tabs
	$("#addMoretab").live("click",function(){      
		addTab();
	});
    
  });

	 
	 